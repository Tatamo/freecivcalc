<!doctype html>
<html lang="<%= language %>">
<head>
	<meta charset="utf-8">
	<title>FreecivCalc2</title>
	<script src="jquery-1.12.3.min.js"></script>
	<script src="jquery-ui.min.js"></script>
	<script src="amcharts/amcharts.js"></script>
	<script src="amcharts/serial.js"></script>
	<script src="widgets.js"></script>
	<script src="tabs.js"></script>
	<script src="freecivcalc.js"></script>
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/jquery-ui.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div style="clear:both" id="tabs">
<ul>
	<li><a href="#tab-main">FreecivCalc</a></li>
</ul>
<div id="tab-main">
	<div class="flex-container">
		<fieldset id="fieldset-attacker">
			<legend><%= unit_select.legend_atk %></legend>
			<div class="ui-widget">
				<label><%= unit_select.select %>: </label>
				<select id="combobox-attack">
				</select>
			</div>
			<p><label><%= unit_select.class %>: </label>
			<input type="hidden" id="attacker-class"><span id="attacker-class-display"></span></p>
			<p><label><%= unit_select.veteran %>: </label>
			<select id="attacker-veteranlevel">
			</select></p>
			<table>
				<tr>
					<td style="text-align:right"><label><%= unit_select.current_hp %>: </label></td><td><input type="number" value="10" min="1" id="attacker-current-hp"></td>
					<td style="text-align:right"><label><%= unit_select.max_hp %>: </label></td><td><input type="number" value="10" min="1" id="attacker-max-hp"></td>
				</tr>
				<tr>
					<td style="text-align:right"><label><%= unit_select.attack %>: </label></td><td><input type="number" value="1" min="1" id="attacker-strength">
						<td style="text-align:right"><label><%= unit_select.firepower %>: </label></td><td><input type="number" value="1" min="1" id="attacker-firepower"></td>
				</tr>
			</table>
		</fieldset>
		<fieldset id="fieldset-defender">
			<legend><%= unit_select.legend_def %></legend>
			<div class="ui-widget">
				<label><%= unit_select.select %>: </label>
				<select id="combobox-defence">
				</select>
			</div>
			<p><label><%= unit_select.class %>: </label>
			<input type="hidden" id="defender-class"><span id="defender-class-display"></span></p>	
			<p><label><%= unit_select.veteran %>: </label>
			<select id="defender-veteranlevel">
			</select></p>
			<table>
				<tr>
					<td style="text-align:right"><label><%= unit_select.current_hp %>: </label></td><td><input type="number" value="10" min="1" id="defender-current-hp"></td>
					<td style="text-align:right"><label><%= unit_select.max_hp %>: </label></td><td><input type="number" value="10" min="1" id="defender-max-hp"></td>
				</tr>
				<tr>
					<td style="text-align:right"><label><%= unit_select.defence %>: </label></td><td><input type="number" value="1" min="1" id="defender-strength">
						<td style="text-align:right"><label><%= unit_select.firepower %>: </label></td><td><input type="number" value="1" min="1" id="defender-firepower"></td>
				</tr>
			</table>
		</fieldset>
	</div>
	<fieldset>
		<legend><%= adjustments.legend %></legend>
		<fieldset id="fieldset-terrains">
			<legend><%= adjustments.legend_terrains %></legend>
			<label><%= adjustments.select_terrain %>: </label>
			<select id="select-terrain">
			</select>
			<span id="flags-roads">
			<!-- <input type="checkbox" id="river"><label for="river"><%= adjustments.terrain_river %></label> -->
	   </span>
		</fieldset>
		<fieldset id="fieldset-in-city">
			<legend><input type="radio" name="in-city-or-open" value="city" id="in-city"><label for="in-city"  title="land units gain 150% defence adjustments"><%= adjustments.legend_in_city %></label></legend>
			<label><%= adjustments.defence_structure %>: </label>
			<ul id="list-structure" style="list-style-type:none; margin-top:3px; padding-left:1em">
				<!--
				<li><input type="checkbox" id="city-walls"><label for="city-walls"><%= adjustments.defence_structure.city_walls %></label></li>
				<li><input type="checkbox" id="city-coastal-defense"><label for="city-coastal-defense"><%= adjustments.defence_structure.coastal_defense %></label></li>
				<li><input type="checkbox" id="city-sam-battery"><label for="city-sam-battery"><%= adjustments.defence_structure.sam_battery %></label></li>
				<li><input type="checkbox" id="city-sdi-defense"><label for="city-sdi-defense"><%= adjustments.defence_structure.sdi_defense %></label></li>
				-->
			</ul>
		</fieldset>
		<fieldset id="fieldset-in-open">
			<legend><input type="radio" name="in-city-or-open" value="open" id="in-open"><label for="in-open"><%= adjustments.legend_in_open %><label></legend>
			<input type="checkbox" id="defender-fortified"><label for="defender-fortified" title="valid for only land units"><%= adjustments.fortified %></label>
			<span id="flags-bases">
			<!-- <input type="checkbox" id="in-fortress"><label for="in-fortress" title="valid for only land units"><%= adjustments.in_fortress %></label> -->
			</span>
		</fieldset>
		<span id="flags-ex">
		</span>
	</fieldset>
	<button type="button" id="calc"><%= calc %></button>
	<div id="result-wrapper" style="display:none">
		<table id="result-table">
			<tr>
				<th><%= result.unit_side %></th>
				<th><%= result.strength %></th>
				<th><%= result.prob %></th>
				<th><%= result.exp %></th>
			</tr>
		</table>
	</div>
<button id="add-tab">addTab</button>
<div style="display:none" id="result-template">
	<div class="flex-container">
		<fieldset id="fieldset-attacker-detail" class="fieldset-attacker-detail">
			<legend><%= result_detail.units.atk_legend %></legend>
			<span id="attacker-detail-unitname"></span>
			<table id="attacker-detail">
				<tr>
					<th><%= result_detail.units.hp %></th>
					<th><%= result_detail.units.attack %></th>
					<th><%= result_detail.units.firepower %></th>
				</tr>
				<tr>
					<td id="attacker-detail-hp"></td>
					<td id="attacker-detail-attack-raw"></td>
					<td id="attacker-detail-firepower-raw"></td>
				</tr>
				<tr>
					<th><%= result_detail.units.mod %></th>
					<th><%= result_detail.units.modified_strength %></th>
					<th><%= result_detail.units.firepower %></th>
				</tr>
				<tr>
					<td></td>
					<td id="attacker-detail-attack-mod"></td>
					<td id="attacker-detail-firepower-mod"></td>
				</tr>
			</table>
		</fieldset>
		<fieldset id="fieldset-defender-detail" class="fieldset-defender-detail">
			<legend><%= result_detail.units.def_legend %></legend>
			<span id="defender-detail-unitname"></span>
			<table id="defender-detail">
				<tr>
					<th><%= result_detail.units.hp %></th>
					<th><%= result_detail.units.defence %></th>
					<th><%= result_detail.units.firepower %></th>
				</tr>
				<tr>
					<td id="defender-detail-hp"></td>
					<td id="defender-detail-defence-raw"></td>
					<td id="defender-detail-firepower-raw"></td>
				</tr>
				<tr>
					<th><%= result_detail.units.mod %></th>
					<th><%= result_detail.units.modified_strength %></th>
					<th><%= result_detail.units.firepower %></th>
				</tr>
				<tr>
					<td></td>
					<td id="defender-detail-defence-mod"></td>
					<td id="defender-detail-firepower-mod"></td>
				</tr>
			</table>
		</fieldset>
	</div>
	<fieldset id="fieldset-adjustments">
		<legend><%= result_detail.adjustments.legend %></legend>
		<table id="adjustments-detail" data-effects='<%= JSON.stringify(result_detail.adjustment_effect_name) %>'>
			<tr>
				<th><%= result_detail.adjustments.label %></th>
				<th><%= result_detail.adjustments.effect %></th>
				<th><%= result_detail.adjustments.value %></th>
			</tr>
		</table>
	</fieldset>
	<div class="flex-container">
		<fieldset id="fieldset-exp-attacker" class="fieldset-exp-attacker">
			<legend><%= result_detail.exp.atk_legend %></legend>
			<div id="chart-exp-attacker" style="width: 100%; height: 300px;"></div>
		</fieldset>
		<fieldset id="fieldset-exp-defender" class="fieldset-exp-defender">
			<legend><%= result_detail.exp.def_legend %></legend>
			<div id="chart-exp-defender" style="width: 100%; height: 300px;"></div>
		</fieldset>
	</div>
</div>
</body>
</html>
