<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>FreecivCalc2</title>
	<script src="lib/jquery-1.12.3.min.js"></script>
	<script src="lib/jquery-ui.min.js"></script>
	<script src="lib/amcharts.js"></script>
	<script src="lib/serial.js"></script>
	<script src="widgets.js"></script>
	<script src="freecivcalc.js"></script>
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/jquery-ui.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="main">
	<h1>FreecivCalc2</h1>
	<span id="display-error"></span>
	<div id="freecivcalc" data-default-dataset-path="./data/freecivcalc_en.json">
	</div>
	<p id="select-lang">
		<span class="link-lang"><a href="./">日本語</a></span>
		<span class="link-lang">English</span>
	</p>
	<footer>
		<p><a href="https://github.com/Tatamo/freecivcalc" target="_blank">github repository</a></p>
		<p>Copyright (c) 2016 <a href="http://tatamo.81.la/" target="_blank">Tatamo</a>.</p>
	</footer>
</div>
<template id="freecivcalc-template">
<div id="tabs">
<ul>
	<li><a href="#tab-main">FreecivCalc</a></li>
	<li><a href="#tab-config">Config</a></li>
</ul>
<div id="tab-main">
	<div class="flex-container">
		<fieldset id="fieldset-attacker">
			<legend>Attacker unit</legend>
			<table class="table-unit-select">
				<tr>
					<td><label>Select unit: </label></td>
					<td><select id="combobox-attack"></select></td>
				</tr>
				<tr>
					<td><label>Unit class: </label></td>
					<td><input type="hidden" id="attacker-class"><span id="attacker-class-display"></span></td>
				</tr>
				<tr>
					<td><label>Veteran level: </label></td>
					<td><select id="attacker-veteranlevel"></select></td>
				</tr>
			</table>
			<table>
				<tr>
					<td><label>Current HP: </label></td><td><input type="number" value="10" min="1" id="attacker-current-hp"></td>
					<td><label>Max HP: </label></td><td><input type="number" value="10" min="1" id="attacker-max-hp"></td>
				</tr>
				<tr>
					<td><label>Attack: </label></td><td><input type="number" value="1" min="1" id="attacker-strength">
						<td><label>Firepower: </label></td><td><input type="number" value="1" min="1" id="attacker-firepower"></td>
				</tr>
			</table>
		</fieldset>
		<fieldset id="fieldset-defender">
			<legend>Defender unit</legend>
			<table class="table-unit-select">
				<tr>
					<td><label>Select unit: </label></td>
					<td><select id="combobox-defence"></select></td>
				</tr>
				<tr>
					<td><label>Unit class: </label></td>
					<td><input type="hidden" id="defender-class"><span id="defender-class-display"></span></td>
				</tr>
				<tr>
					<td><label>Veteran level: </label></td>
					<td><select id="defender-veteranlevel"></select></td>
				</tr>
			</table>
			<table>
				<tr>
					<td><label>Current HP: </label></td><td><input type="number" value="10" min="1" id="defender-current-hp"></td>
					<td><label>Max HP: </label></td><td><input type="number" value="10" min="1" id="defender-max-hp"></td>
				</tr>
				<tr>
					<td><label>Decence: </label></td><td><input type="number" value="1" min="1" id="defender-strength">
						<td><label>Firepower: </label></td><td><input type="number" value="1" min="1" id="defender-firepower"></td>
				</tr>
			</table>
		</fieldset>
	</div>
	<fieldset>
		<legend>Defender adjustments</legend>
		<fieldset id="fieldset-terrains">
			<legend>Terrains</legend>
			<label>Terrain: </label>
			<select id="select-terrain">
			</select>
			<span id="flags-roads">
	   </span>
		</fieldset>
		<fieldset id="fieldset-in-city">
			<legend><input type="radio" name="in-city-or-open" value="city" id="in-city"><label for="in-city"  title="land units gain 150% defence adjustments">In city</label></legend>
			<label>Defence structures: </label>
			<ul id="list-structure">
			</ul>
		</fieldset>
		<fieldset id="fieldset-in-open">
			<legend><input type="radio" name="in-city-or-open" value="open" id="in-open"><label for="in-open">Out of city</label></legend>
			<input type="checkbox" id="defender-fortified"><label for="defender-fortified" title="valid for only land units">Land unit fortified</label>
			<span id="flags-bases">
			</span>
		</fieldset>
		<span id="flags-ex">
		</span>
	</fieldset>
	<button type="button" id="calc">Calc</button>
	<div id="result-wrapper" style="display:none">
		<table id="result-table">
			<tr>
				<th>Unit side</th>
				<th>Strength</th>
				<th>Probability of winning</th>
				<th>Expected hp left</th>
			</tr>
			<tr>
				<td id="attacker-result-side">Attacker</td>
				<td id="attacker-result-strength"></td>
				<td id="attacker-result-prob"></td>
				<td id="attacker-result-exp"></td>
			</tr>
			<tr>
				<td id="defender-result-side">Defender</td>
				<td id="defender-result-strength"></td>
				<td id="defender-result-prob"></td>
				<td id="defender-result-exp"></td>
			</tr>
		</table>
		<button id="add-tab">Open detail tab</button>
	</div>
</div>
<div id="tab-config">
	<fieldset>
		<legend>Dataset config</legend>
		<p>Current dataset: <span id="current-dataset"></span></p>
		<p>Freeciv version: <span id="current-dataset-freeciv-version"></span></p>
		<fieldset>
			<legend>Select dataset</legend>
			<p>
				<label>Dataset: </label>
				<select id="select-dataset">
					<option value="./data/freecivcalc_en.json" selected>Freeciv2.5 Classic(English)</option>
					<option value="./data/freecivcalc_ja.json">Freeciv2.5 Classic(Japanese)</option>
				</select>
				<a id="dataset-download">Download this dataset</a>
			</p>
			<p>
				<button id="selected-dataset-apply">Apply</button>
			</p>
		</fieldset>
		<fieldset>
			<legend>Load dataset from local</legend>
			<p>
				<label>Dataset: </label>
				<input type="file" id="dataset-load">
			</p>
			<p>
				<button id="local-dataset-apply" disabled>Apply</button>
				<span id="display-error-local-dataset-load" style="display:none">failed to load dataset (invalid dataset JSON file)</span>
			</p>
		</fieldset>
	</fieldset>
</div>
</div>
<template id="result-template">
	<div class="flex-container">
		<fieldset id="fieldset-attacker-detail" class="fieldset-attacker-detail">
			<legend>Attacker unit: <span id="attacker-detail-unitname"></span></legend>
			<p>Probability of winning: <span id="attacker-detail-prob"></span></p>
			<table id="attacker-detail">
				<tr>
					<th>HP</th>
					<th>Attack</th>
					<th>Firepower</th>
				</tr>
				<tr>
					<td id="attacker-detail-hp"></td>
					<td id="attacker-detail-attack-raw"></td>
					<td id="attacker-detail-firepower-raw"></td>
				</tr>
				<tr>
					<th>After modification:</th>
					<th>Strength</th>
					<th>Firepower</th>
				</tr>
				<tr>
					<td></td>
					<td id="attacker-detail-attack-mod"></td>
					<td id="attacker-detail-firepower-mod"></td>
				</tr>
			</table>
		</fieldset>
		<fieldset id="fieldset-defender-detail" class="fieldset-defender-detail">
			<legend>Defender unit: <span id="defender-detail-unitname"></span></legend>
			<p>Probability of winning: <span id="defender-detail-prob"></span></p>
			<table id="defender-detail">
				<tr>
					<th>HP</th>
					<th>Decence</th>
					<th>Firepower</th>
				</tr>
				<tr>
					<td id="defender-detail-hp"></td>
					<td id="defender-detail-defence-raw"></td>
					<td id="defender-detail-firepower-raw"></td>
				</tr>
				<tr>
					<th>After modification:</th>
					<th>Strength</th>
					<th>Firepower</th>
				</tr>
				<tr>
					<td></td>
					<td id="defender-detail-defence-mod"></td>
					<td id="defender-detail-firepower-mod"></td>
				</tr>
			</table>
		</fieldset>
	</div>
	<fieldset id="fieldset-adjustments">
		<legend>Strength adjustments</legend>
		<table id="adjustments-detail" data-effects='{&#34;attacker-strength-multiply&#34;:&#34;Attacker strength multiply(%)&#34;,&#34;defender-strength-multiply&#34;:&#34;Defender strength multiply(%)&#34;,&#34;attacker-firepower-multiply&#34;:&#34;Attacker firepower multiply(%)&#34;,&#34;defender-firepower-multiply&#34;:&#34;Defender firepower multiply(%)&#34;,&#34;attacker-firepower-set&#34;:&#34;Set attacker firepower&#34;,&#34;defender-firepower-set&#34;:&#34;Set defender firepower&#34;}'>
			<tr>
				<th>Adjustment</th>
				<th>Effect</th>
				<th>Value</th>
			</tr>
		</table>
	</fieldset>
	<div class="flex-container">
		<fieldset id="fieldset-exp-attacker" class="fieldset-exp-attacker">
			<legend>Attacker expected HP graph</legend>
			<p>Expected HP left: <span id="attacker-detail-exp"></span></p>
			<div id="chart-exp-attacker" style="width: 100%; height: 300px;"></div>
		</fieldset>
		<fieldset id="fieldset-exp-defender" class="fieldset-exp-defender">
			<legend>Defender expected HP graph</legend>
			<p>Expected HP left: <span id="defender-detail-exp"></span></p>
			<div id="chart-exp-defender" style="width: 100%; height: 300px;"></div>
		</fieldset>
	</div>
</template>
</template>
</body>
</html>
