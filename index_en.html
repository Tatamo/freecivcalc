<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>FreecivCalc2</title>
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
	<script src="amcharts.js" type="text/javascript"></script>
	<script src="serial.js" type="text/javascript"></script>
	<style>
.custom-combobox {
	position: relative;
	display: inline-block;
}
.custom-combobox-toggle {
	position: absolute;
	top: 0;
	bottom: 0;
	margin-left: -1px;
	padding: 0;
}
.ui-autocomplete {
	max-height: 400px;
	overflow-y: auto;
	overflow-x: hidden;
}
.flex-container{
	display: -webkit-flex;
	display: flex;
}
#fieldset-attacker{
	-webkit-flex: 1;
	flex: 1;
}
#fieldset-attacker-detail{
	-webkit-flex: 1;
	flex: 1;
}
#fieldset-exp-attacker{
	-webkit-flex: 1;
	flex: 1;
}

	</style>
	<script src="widgets.js"></script>
	<script src="tabs.js"></script>
	<script src="freecivcalc.js"></script>
</head>
<body>
<div style="clear:both" id="tabs">
<ul>
	<li><a href="#tab-main">FreecivCalc</a></li>
</ul>
<div id="tab-main">
	<div class="flex-container">
		<fieldset id="fieldset-attacker">
			<legend>attacker unit</legend>
			<div class="ui-widget">
				<label>Select unit: </label>
				<select id="combobox-attack">
				</select>
			</div>
			<p><label>unit class: </label>
			<input type="hidden" id="attacker-class"><span id="attacker-class-display"></span></p>
			<p><label>veteran level: </label>
			<select id="attacker-veteranlevel">
			</select></p>
			<table>
				<tr>
					<td style="text-align:right"><label>current HP: </label></td><td><input type="number" value="10" min="1" id="attacker-current-hp"></td>
					<td style="text-align:right"><label>max HP: </label></td><td><input type="number" value="10" min="1" id="attacker-max-hp"></td>
				</tr>
				<tr>
					<td style="text-align:right"><label>attack: </label></td><td><input type="number" value="1" min="1" id="attacker-strength">
						<td style="text-align:right"><label>firepower: </label></td><td><input type="number" value="1" min="1" id="attacker-firepower"></td>
				</tr>
			</table>
		</fieldset>
		<fieldset id="fieldset-defender">
			<legend>defender unit</legend>
			<div class="ui-widget">
				<label>Select unit: </label>
				<select id="combobox-defence">
				</select>
			</div>
			<p><label>unit class: </label>
			<input type="hidden" id="defender-class"><span id="defender-class-display"></span></p>	
			<p><label>veteran level: </label>
			<select id="defender-veteranlevel">
			</select></p>
			<table>
				<tr>
					<td style="text-align:right"><label>current HP: </label></td><td><input type="number" value="10" min="1" id="defender-current-hp"></td>
					<td style="text-align:right"><label>max HP: </label></td><td><input type="number" value="10" min="1" id="defender-max-hp"></td>
				</tr>
				<tr>
					<td style="text-align:right"><label>decence: </label></td><td><input type="number" value="1" min="1" id="defender-strength">
						<td style="text-align:right"><label>firepower: </label></td><td><input type="number" value="1" min="1" id="defender-firepower"></td>
				</tr>
			</table>
		</fieldset>
	</div>
	<fieldset>
		<legend>defender adjustments</legend>
		<fieldset id="fieldset-terrains">
			<legend>terrains</legend>
			<label>terrain: </label>
			<select id="select-terrain">
			</select>
			<input type="checkbox" id="terrain-river"><label for="terrain-river">river(150%)</label>
		</fieldset>
		<fieldset id="fieldset-in-city">
			<legend><label for="in-city"  title="land units gain 150% defence adjustments"><input type="radio" name="in-city-or-open" value="city" id="in-city">in city</label></legend>
			<label>defence structures: </label>
			<ul style="list-style-type:none; margin-top:3px; padding-left:1em">
				<li><label for="city-walls"><input type="checkbox" id="city-walls">city walls(300% against land unit or helicopter(except howitzer))</label></li>
				<li><label for="city-coastal-defense"><input type="checkbox" id="city-coastal-defense">coastal defense(200% against ship)</label></li>
				<li><label for="city-sam-battery"><input type="checkbox" id="city-sam-battery">SAM battery(200% against aircraft(except helicopter))</label></li>
				<li><label for="city-sdi-defense"><input type="checkbox" id="city-sdi-defense">SDI defense(200% against missile)</label></li>
			</ul>
		</fieldset>
		<fieldset id="fieldset-in-open">
			<legend><input type="radio" name="in-city-or-open" value="open" id="in-open"><label for="in-open">out of city<label></legend>
			<label for="defender-fortified" title="valid for only land units"><input type="checkbox" id="defender-fortified">land unit fortified(150%)</label>
			<label for="in-fortress" title="valid for only land units"><input type="checkbox" id="in-fortress">land unit in fortress(200%)</label>
		</fieldset>
	</fieldset>
	<button type="button" id="calc">Calc</button>
	<div id="result-wrapper" style="display:none">
		<table id="result-table">
			<tr>
				<th>Unit side</th>
				<th>Strength</th>
				<th>Probability of winning</th>
				<th>Ecpected hp left</th>
			</tr>
		</table>
	</div>
<button id="add-tab">addTab</button>
<div style="display:none" id="result-template">
	<fieldset id="fieldset-adjustments">
		<legend>strength adjustments</legend>
		<table id="adjustments-detail" data-effects='{&#34;attacker-strength-multiply&#34;:&#34;攻撃側能力値補正(%)&#34;,&#34;defender-strength-multiply&#34;:&#34;防御側能力値補正(%)&#34;,&#34;attacker-firepower-multiply&#34;:&#34;攻撃側火力補正(%)&#34;,&#34;defender-firepower-multiply&#34;:&#34;防御側火力補正(%)&#34;,&#34;attacker-firepower-set&#34;:&#34;攻撃側火力変更&#34;,&#34;defender-firepower-set&#34;:&#34;防御側火力変更&#34;}'>
			<tr>
				<th>adjustment</th>
				<th>effect</th>
				<th>value</th>
			</tr>
		</table>
	</fieldset>
	<div class="flex-container" style="width:900px">
		<fieldset id="fieldset-exp-attacker">
			<legend>攻撃ユニット残HP期待値</legend>
			<div id="chart-exp-attacker" style="width: 100%; height: 300px;"></div>
		</fieldset>
		<fieldset id="fieldset-exp-defender">
			<legend>防御ユニット残HP期待値</legend>
			<div id="chart-exp-defender" style="width: 100%; height: 300px;"></div>
		</fieldset>
	</div>
</div>
</body>
</html>
